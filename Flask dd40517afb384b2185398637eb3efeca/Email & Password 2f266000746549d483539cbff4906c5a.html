<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Email &amp; Password</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2f266000-7465-49d4-8353-9cbff4906c5a" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">üì®</span></div><h1 class="page-title">Email &amp; Password</h1></header><div class="page-body"><p id="13c829d2-4ab6-4b75-b3cd-5ce87d288874" class="">How to use email to allow users to reset their passwords.<div class="indented"><ol type="1" id="9edef7c7-6b74-414d-8990-263a454d0eee" class="numbered-list" start="1"><li>Generate a secure time-sensitive  token that we can use to make sure that only someone who has access to user‚Äôs email can reset their password.</li></ol><ol type="1" id="1f1306cf-9465-415e-a014-3426d4f1955f" class="numbered-list" start="2"><li>Email the link to reset.</li></ol></div></p><h1 id="f581f9cc-9ec2-4a93-9ce9-44d29fa8df7c" class="">Secure Time Sensitive Token</h1><p id="d445510a-c7a2-40e3-a971-d93696389104" class="">Sometimes you just want to send some data to untrusted environments. But how to do this safely? The trick involves signing. Given a key only you know, you can cryptographically sign your data and hand it over to someone else. When you get the data back you can easily ensure that nobody tampered with it.</p><p id="b551a709-feda-4194-8868-bef71051905e" class="">You can serialize and sign a user ID in a URL and email it to them to unsubscribe from a newsletter. This way you don‚Äôt need to generate one-time tokens and store them in the database. Same thing with any kind of activation link for accounts and similar things.</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="41d14b6c-3e37-42de-a469-189f28978a54"><div style="font-size:1.5em"><span class="icon">üí°</span></div><div style="width:100%">‚Äúitsdangerous‚Äù package
Refer : <a href="https://itsdangerous.palletsprojects.com/en/1.1.x/">https://itsdangerous.palletsprojects.com/en/1.1.x/</a>
</div></figure><p id="c401877a-797c-4fd8-a18e-d72b8aabf4cd" class="">A package called ‚Äúitsdangerous‚Äù pre installed with flask itself helps to generate this secure time sensitive token. ( But install the version itsdangerous == 1.1.0)</p><p id="9ed41034-f65e-4f68-b533-7cbea04aa87b" class="">The <a href="https://itsdangerous.palletsprojects.com/en/1.1.x/signer/">Signing Interface</a> only signs strings. To sign other types, the <a href="https://itsdangerous.palletsprojects.com/en/1.1.x/serializer/#itsdangerous.serializer.Serializer"><code>Serializer</code></a> class provides a <code>dumps </code>/<code>loads</code> interface similar to Python‚Äôs <a href="https://docs.python.org/3/library/json.html#module-json"><code>json</code></a> module, which serializes the object to a string then signs that.</p><p id="1da747d3-6663-43c1-bf39-74c86b8472fa" class="">To record and validate the age of the signature, see <a href="https://itsdangerous.palletsprojects.com/en/1.1.x/timed/">Signing With Timestamps</a>. To serialize to a format that is safe to use in URLs, see <a href="https://itsdangerous.palletsprojects.com/en/1.1.x/url_safe/">URL Safe Serialization</a>.</p><h2 id="3e16bd36-fe80-403a-aeb9-9fed8aad8ff6" class=""><strong>JSON Web Signature (JWS)</strong></h2><p id="40991ab4-a799-463a-93cf-bed4b7f06c22" class="">JSON Web Signatures (JWS) work similarly to the existing URL safe serializer but will emit headers according to <a href="http://self-issued.info/docs/draft-ietf-jose-json-web-signature.html">draft-ietf-jose-json-web-signature</a>.</p><p id="9180331d-7d57-4087-927f-3b005ae17f93" class="">Three parts<div class="indented"><ol type="1" id="4eb044b5-e061-4711-bcfa-a2d742f9cabb" class="numbered-list" start="1"><li>JOSE Header</li></ol><ol type="1" id="d4b1e54d-6ab8-4dc6-91a7-b09995762aa1" class="numbered-list" start="2"><li>JWS Payload</li></ol><ol type="1" id="ffd1a283-0859-43fc-9ecf-598d53d002c6" class="numbered-list" start="3"><li>JWS Signature</li></ol></div></p><p id="0b93ebd5-5b90-4309-ad97-c020b870a0ed" class="">These terms are defined by this specification:<div class="indented"><ul id="0cc50288-73f3-4be6-8345-0d82b21ee9d1" class="bulleted-list"><li style="list-style-type:disc"><strong>JSON Web Signature (JWS) -</strong> A data structure representing a digitally signed or MACed message. </li></ul><ul id="3e375e30-b20c-41f5-adc1-b15bdf43ee1d" class="bulleted-list"><li style="list-style-type:disc"><strong> JOSE Header - </strong>JSON object containing the parameters  describing the cryptographic operations and parameters employed.  The JOSE (JSON Object Signing and Encryption) Header is comprised of a set of Header Parameters.  </li></ul><ul id="904870fd-90ab-4f6f-9b2d-23d3975a0e23" class="bulleted-list"><li style="list-style-type:disc"><strong>JWS Payload -</strong> The sequence of octets to be secured -- a.k.a. the message.  The payload can contain an arbitrary sequence of octets. </li></ul><ul id="630902ae-ee9d-4940-a3b5-15831e51bb0d" class="bulleted-list"><li style="list-style-type:disc"> <strong>JWS Signature -</strong> Digital signature or MAC over the JWS Protected Header and the JWS Payload.  </li></ul><ul id="0f0ff130-4176-423e-9c79-f0e20007f1f5" class="bulleted-list"><li style="list-style-type:disc"><strong>Header Parameter -</strong> A name/value pair that is member of the JOSE Header.</li></ul></div></p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="9ba317b7-906e-4baa-a9b3-0a46d9924625"><div style="font-size:1.5em"><span class="icon">üí°</span></div><div style="width:100%">JWS support (<code>JSONWebSignatureSerializer</code>,<code>TimedJSONWebSignatureSerializer</code>) is deprecated. Use a dedicated JWS/JWT library such as authlib instead.<p id="98a09893-c3ad-4750-aa3f-59a511959aea" class=""><a href="https://itsdangerous.palletsprojects.com/en/1.1.x/jws/">https://itsdangerous.palletsprojects.com/en/1.1.x/jws/</a></p><p id="a9077fd3-ec95-4482-9bc9-36136b5cb62e" class="">
</p><p id="d6e35bd1-7725-41d4-b0f9-045d7c173d25" class=""><code>TimedJSONWebSignatureSerializer</code>(<em>secret_key</em>, <em>expires_in=None</em>, <em>**kwargs</em>)<div class="indented"><p id="f4e4e965-2e4b-4089-a427-6034761af9ce" class="">Works like the regular <a href="https://itsdangerous.palletsprojects.com/en/1.1.x/jws/#itsdangerous.jws.JSONWebSignatureSerializer"><code>JSONWebSignatureSerializer</code></a> but also records the time of the signing and can be used to expire signatures.</p></div></p></div></figure><p id="439c67af-39ba-4d78-9104-b980bc33fb01" class="">
</p><figure id="983c1caf-a208-493e-a254-56c466e2dc3c" class="image"><a href="Email%20&amp;%20Password%202f266000746549d483539cbff4906c5a/Untitled.png"><img style="width:768px" src="Email%20&amp;%20Password%202f266000746549d483539cbff4906c5a/Untitled.png"/></a></figure><ol type="1" id="8b6394c0-5136-45d9-9697-386a5a1655bc" class="numbered-list" start="1"><li>We gave ‚Äòsecret‚Äô as secret key  and 30 secs of expiration time.</li></ol><ol type="1" id="0cea4ab7-3cd0-40de-bcf5-fc44629d2753" class="numbered-list" start="2"><li>We dump the payload (message) as user id.</li></ol><ol type="1" id="e9d7a468-82ab-4ed0-80df-e3a718606644" class="numbered-list" start="3"><li>JWT ( JSON Web Token) generated.</li></ol><ol type="1" id="5a4147ce-c689-4e19-bfc0-260bc7b719b6" class="numbered-list" start="4"><li> We can decode  the payload in that token by Serializer.loads(token)</li></ol><ol type="1" id="00082fe4-19d6-4c5b-a856-0fed2f11bba1" class="numbered-list" start="5"><li>Once the token expired (after 30 secs here) will raise an error when we try to decode that token.</li></ol><p id="c09a1a0f-3dad-4ad8-8809-24ef0bd7d891" class=""> </p><figure id="6464fc94-c287-4ba6-837b-8cb744323140" class="image"><a href="Email%20&amp;%20Password%202f266000746549d483539cbff4906c5a/Untitled%201.png"><img style="width:624px" src="Email%20&amp;%20Password%202f266000746549d483539cbff4906c5a/Untitled%201.png"/></a></figure><ol type="1" id="966db846-37b0-41d0-b860-18769d6f1005" class="numbered-list" start="1"><li> Algorithm used <mark class="highlight-pink">SHA-512</mark>.</li></ol><ol type="1" id="b75af194-3da2-4cf9-b2dc-c046c137e90d" class="numbered-list" start="2"><li>iat ‚Äî&gt; signed time ; exp‚Äî&gt;expiring time [exp (=1655974457) - iat(=1655974427) = 30 secs ].</li></ol><ol type="1" id="fae0f083-9647-42fe-913b-52fcfb597e6d" class="numbered-list" start="3"><li>Message encoded/dumped</li></ol><ol type="1" id="df6bb6d5-21e1-4410-9156-38404cdd991b" class="numbered-list" start="4"><li>Digital signature.</li></ol><p id="9367c429-0f80-470d-a701-c21483eec888" class=""> </p><h2 id="efc1ecd4-fec6-40ea-8bbd-ae27855cc77c" class="">Functions to create and validate token</h2><p id="d32a621d-8d93-4050-9f10-b8ef80598cd6" class="">In user model we create methods to generate and validate the tokens,</p><pre id="66621bab-1bf2-443d-b179-59107c6956cf" class="code"><code>from itsdangerous import TimedJSONWebSignatureSerializer as Serializer
from flaskblog import app 
#we need our app secret key

class User(db.Model,UserMixin):
    .
		.
		.    
    def get_reset_token(self, expires_sec=1800):
        s = Serializer(app.config[&#x27;SECRET_KEY&#x27;], expires_sec)
        return s.dumps({&#x27;user_id&#x27;: self.id}).decode(&#x27;utf-8&#x27;)

    @staticmethod                               
    def verify_reset_token(token):
        s = Serializer(app.config[&#x27;SECRET_KEY&#x27;])
        try:
            user_id = s.loads(token)[&#x27;user_id&#x27;]
        except:
            return None
        return User.query.get(user_id)</code></pre><ul id="e40ed640-2a95-4a8a-91e2-70a0a61dc88d" class="bulleted-list"><li style="list-style-type:disc">This verify_reset_token method never uses self variables. It doesn‚Äôt do anything with th instance of the user. Such methods are called <mark class="highlight-pink">static methods. </mark>To tell python this is static method and not to expect self as an argument, we can simply add <mark class="highlight-pink">@staticmethod</mark> decorator.</li></ul><ul id="87a7d624-a563-49f9-a59c-f6b32473135f" class="bulleted-list"><li style="list-style-type:disc">The token may be invalid or expired, to handle this we use try-except block.</li></ul><h2 id="a0321dc8-4fb9-49ec-9ed7-4f37de2b22bb" class="">Forms </h2><h3 id="738f07ca-7e4c-4e79-a653-5fadc990319c" class="">Reset Request Form</h3><pre id="e465597a-2eb9-4b95-abfa-fcc33c6e6762" class="code"><code>class RequestResetForm(FlaskForm):
    email = StringField(&#x27;Email&#x27;,
                        validators=[DataRequired(), Email()])
    submit = SubmitField(&#x27;Request Password Reset&#x27;)

    def validate_email(self, email):
        user = User.query.filter_by(email=email.data).first()
        if user is None:
            raise ValidationError(&#x27;There is no account with that email. You must register first.&#x27;)</code></pre><h3 id="6d69ac4d-73f9-4039-b8d1-7d5c39a49464" class="">Reset Password Form</h3><pre id="7cc3c0fa-80b1-4b68-b9b6-dcd4df3b5cee" class="code"><code>class ResetPasswordForm(FlaskForm):
    password = PasswordField(&#x27;Password&#x27;, validators=[DataRequired()])
    confirm_password = PasswordField(&#x27;Confirm Password&#x27;,
                                     validators=[DataRequired(), EqualTo(&#x27;password&#x27;)])
    submit = SubmitField(&#x27;Reset Password&#x27;)
</code></pre><h2 id="37253cd2-073d-4be8-a7ab-8f77aa7431ac" class="">Route</h2><pre id="84d5f5ac-7500-4b7a-a807-e66b5d25c6f0" class="code"><code>@app.route(&quot;/reset_password&quot;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])
def reset_request():
    if current_user.is_authenticated:
        return redirect(url_for(&#x27;home&#x27;))
    form = RequestResetForm()
    if form.validate_on_submit():
        user = User.query.filter_by(email=form.email.data).first()
        send_reset_email(user)
        flash(&#x27;An email has been sent with instructions to reset your password.&#x27;, &#x27;info&#x27;)
        return redirect(url_for(&#x27;login&#x27;))
    return render_template(&#x27;reset_request.html&#x27;, title=&#x27;Reset Password&#x27;, form=form)</code></pre><p id="c2a6da8a-76f7-4575-b058-ae92982e05ca" class="">If the user is logged in then redirect the user to home page because user must be logged out in order to request the reset password (That is <strong>Forgot Password?</strong>).</p><p id="8e775e9b-9f3b-4b5b-a72a-8756602f67bb" class=""> Incase of valid email ID send the reset password link. </p><pre id="73f25bb1-c635-4aab-bbc5-a7d35b6c50ce" class="code"><code>@app.route(&quot;/reset_password/&lt;token&gt;&quot;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])
def reset_token(token):
    if current_user.is_authenticated:
        return redirect(url_for(&#x27;home&#x27;))
    user = User.verify_reset_token(token)
    if user is None:
        flash(&#x27;That is an invalid or expired token&#x27;, &#x27;warning&#x27;)
        return redirect(url_for(&#x27;reset_request&#x27;))
    form = ResetPasswordForm()
    return render_template(&#x27;reset_token.html&#x27;, title=&#x27;Reset Password&#x27;, form=form)</code></pre><p id="345230bf-e7eb-4cc8-84fd-759c3e281cb8" class="">If the token is invalid or expired redirect the user to reset request page.</p><h1 id="ec4900fe-a33a-454b-9a81-93ab41c42a32" class="">Mail</h1><pre id="3bd30a5b-77df-412a-934e-d141a96c0ec8" class="code"><code>pip install flask-mail
from flask_mail import Mail</code></pre><h2 id="2e61fd85-a7c5-49bb-92fa-ae3f79e95362" class="">Configuring the app variable</h2><pre id="dec7b358-0d28-4091-b21e-2d3732469b95" class="code"><code>
# Gamil 
app.config[&#x27;MAIL_SERVER&#x27;] = &#x27;smtp.googlemail.com&#x27;
app.config[&#x27;MAIL_PORT&#x27;] = 587
app.config[&#x27;MAIL_USE_TLS&#x27;] = True
app.config[&#x27;MAIL_USERNAME&#x27;] = os.environ.get(&#x27;EMAIL_USER&#x27;)
app.config[&#x27;MAIL_PASSWORD&#x27;] = os.environ.get(&#x27;EMAIL_PASS&#x27;)
mail = Mail(app)</code></pre><p id="870e95d7-c6c5-4973-94c8-0cf173422b0a" class="">
</p><h2 id="f8656afd-b7a2-46e6-87a7-2969096176ff" class="">Send Mail function:</h2><pre id="314cda44-b261-4c1e-a780-13423c6be3bd" class="code"><code>from yourapplication imort mail
from flask_mail import Message

def send_reset_email(user):
    token = user.get_reset_token()
    msg = Message(&#x27;Password Reset Request&#x27;,
                  sender=&#x27;noreply@demo.com&#x27;,
                  recipients=[user.email])
    msg.body = f&#x27;&#x27;&#x27;To reset your password, visit the following link:
{url_for(&#x27;reset_token&#x27;, token=token, _external=True)}
If you did not make this request then simply ignore this email and no changes will be made.
&#x27;&#x27;&#x27;
    mail.send(msg)</code></pre><ul id="aedddeae-6ab7-4423-b936-cad540d395cd" class="bulleted-list"><li style="list-style-type:disc">get_reset_token() of user module generate the token.</li></ul><ul id="89433eef-05c7-459b-a225-eb44a64338e9" class="bulleted-list"><li style="list-style-type:disc">Message( ) takes first argument as subject line </li></ul><ul id="12a22382-0191-43f0-bdce-9d49fb85d491" class="bulleted-list"><li style="list-style-type:disc">Message body contains multiline string<figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="d3aeba7e-de3d-4e3b-ab6d-a9868d829a61"><div style="font-size:1.5em"><span class="icon">üí°</span></div><div style="width:100%">In multiline string, it is important to arrange all the line beginnings to the base line because the string captures tab also. So, if you indent the line beginnings it will reflect in your message.</div></figure></li></ul><ul id="d1d33d7c-f4f6-4e6a-bf0f-a1937340e557" class="bulleted-list"><li style="list-style-type:disc">url_for(_external=true) will return a absolute link rather than relative link.</li></ul><ul id="47784f16-7f75-4bf9-801e-2602f91ba9c1" class="bulleted-list"><li style="list-style-type:disc">Send the message to the sender‚Äôs mail id</li></ul><p id="3b9cc367-f4d5-4d6d-9615-861bdaadb260" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="79c5b5f5-c1e4-487b-9597-8718a00a8ba5"><div style="font-size:1.5em"><span class="icon">üí°</span></div><div style="width:100%"><a href="https://mailtrap.io/blog/flask-email-sending/">https://mailtrap.io/blog/flask-email-sending/</a></div></figure><h2 id="159fc4ad-473b-42ba-a8c5-e7a032a9296f" class="">Reset the password</h2><figure id="a19a7811-0d74-4b01-b8d2-4af541a830ea" class="image"><a href="Email%20&amp;%20Password%202f266000746549d483539cbff4906c5a/Untitled%202.png"><img style="width:1073px" src="Email%20&amp;%20Password%202f266000746549d483539cbff4906c5a/Untitled%202.png"/></a></figure><p id="fbc5eb0d-775c-4004-8b1d-b68db3339229" class="">
</p></div></article></body></html>